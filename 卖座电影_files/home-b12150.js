webpackJsonp([31],{955:function(e,t,n){"use strict";var a=n(143),r=n(229),i=(n(5),n(215),n(226).redirect),l=n(226).hasLogged,c=n(226).isMainAccount,s=n(226).toLogin,o=n(591),u=n(592).StoreWatchMixin,m=n(956),p=n(958),d=r.createClass({displayName:"CenterMain",mixins:[o,u("MeStore","AuthStore")],getStateFromFlux:function(){return{user:this.getFlux().store("MeStore").getMe(),isLogged:this.getFlux().store("AuthStore").getStatus()}},componentDidMount:function(){var e=this.getFlux();if(!l()||c()){if(!l())return s();e.actions.me.get(),e.actions.application.setNavbar({title:"我的"})}},componentDidUpdate:function(e,t){if(this.state.isLogged===!1)return setTimeout(a.partial(i,"#!/login",{trigger:!0,replace:!0}),0)},render:function(){var e=this.state.user.attributes;return r.createElement("section",{className:"center-home-view"},r.createElement(m,{user:e}),r.createElement(p,{user:e}))}});e.exports=d},956:function(e,t,n){"use strict";var a=n(229),r=n(131),i=n(5),l=n(590),c=(n(215),n(226).redirect),s=n(742),o=n(141),u=n(591),m=n(592).StoreWatchMixin,p=a.createClass({displayName:"UserAvatar",render:function(){var e=n(957);return a.createElement("img",{className:"avatar",src:this.props.src||e})}}),d=a.createClass({displayName:"UserName",handelClick:function(){},render:function(){var e=(this.props.name?"inline-block":"none","");return this.props.name&&(e=a.createElement(l,{className:"i-modify",onClick:this.handelClick},"modify")),a.createElement("p",{className:"username"},a.createElement("span",null,this.props.name||"未登录"))}}),h=a.createClass({displayName:"UserId",render:function(){var e=null;return this.props.id&&(e=a.createElement("p",{className:"email"},"ID:"+this.props.id)),e}}),C=(a.createClass({displayName:"PhoneStatus",render:function(){return a.createElement("span",null,"已绑定 ",this.props.mobile,a.createElement("u",null," 绑定手机号 "))}}),a.createClass({displayName:"Logout",mixins:[u,m("MeStore","AuthStore")],getStateFromFlux:function(){return{isLogged:this.getFlux().store("AuthStore").getStatus()}},componentDidUpdate:function(){if(this.state.isLogged===!1)return setTimeout(_.partial(c,"#!/login",{trigger:!0,replace:!0}),0)},handelClick:function(){var e=this;confirm("你确定要退出当前账户？")&&e.getFlux().actions.auth.logout()},render:function(){return a.createElement("span",{className:"logout",onClick:this.handelClick},"退出")}})),f=a.createClass({displayName:"ToSetSecurityMobile",handleClick:function(){c("#!/setting/security-mobile")},render:function(){return a.createElement("span",{className:"bind",onClick:this.handleClick},"绑定手机")}}),g=a.createClass({displayName:"UserNameCard",render:function(){var e=this.props.user;return a.createElement("div",{className:"center-header-wrap"},a.createElement("header",null,a.createElement(p,{src:e.avatorUrl}),a.createElement("div",{className:"detail"},a.createElement(d,{name:e.name}),a.createElement(h,{id:e.id}),a.createElement("p",{className:"operation"},i.get(e,"setting.securityMobile")?null:a.createElement(f,null),s.app.isWeb()||r(o.COOKIE_DEBUG)?a.createElement(C,null):"")),a.createElement("div",{className:"clearfix"})))}});e.exports=g},957:function(e,t,n){e.exports=n.p+"asset/ca426920db24a84a0d98107f5fedc2cc.jpg"},958:function(e,t,n){"use strict";var a=n(229),r=n(388),i=n(5),l=(n(215),n(590)),c=n(226).redirect,s=n(591),o=n(167),u=a.createClass({displayName:"Nav",render:function(){return a.createElement("div",{className:"menu-wrapper "+(this.props.className||""),onClick:this.props.onClick},a.createElement("div",{className:"menu center-block"},a.createElement(l,{className:"menu-icon"},this.props.icon),a.createElement("span",{className:"title"},this.props.title),a.createElement("div",{className:"pull-right"},a.createElement("span",{className:"value-wrap"},a.createElement("span",{className:"value"},this.props.num||0),"账户余额"===this.props.title?" 元":" 张"),"账户余额"===this.props.title?a.createElement("span",{className:"trigger-icon"},"刷新 "):a.createElement(l,{className:"trigger-icon"},"arrow-right"))))}}),m=a.createClass({displayName:"Order",handleClick:function(){c("#!/center/ticket")},render:function(){return a.createElement(u,{onClick:this.handleClick,num:this.props.num,title:"影票订单",icon:"ticket-filled"})}}),p=a.createClass({displayName:"Preorder",handleClick:function(){c("#!/preorder")},render:function(){return a.createElement(u,{onClick:this.handleClick,num:this.props.num,title:"影票待付订单",icon:"sandglass-filled"})}}),d=a.createClass({displayName:"Mall",handleClick:function(){var e="http://aura.maizuo.com/?showwxpaytitle=1#!/center/order",t="http://aura.maizuo.com/connect/redirect?re_url="+encodeURIComponent(e);c("http://m.maizuo.com/act/passport?url="+encodeURIComponent(t))},render:function(){return a.createElement(u,{onClick:this.handleClick,className:"mall",title:"商城订单",icon:"mall-filled"})}}),h=a.createClass({displayName:"Ticket",handleClick:function(){var e="http://ticket.maizuo.com/#/order",t="http://ticket.maizuo.com/connect/callback?url="+encodeURIComponent(e);c("http://m.maizuo.com/act/passport?url="+encodeURIComponent(t))},render:function(){return a.createElement(u,{onClick:this.handleClick,className:"ticket",title:"演出订单",icon:"show-filled"})}}),C=a.createClass({displayName:"Coupon",handleClick:function(){c("#!/center/coupon")},render:function(){return a.createElement(u,{className:"cash",num:this.props.num,onClick:this.handleClick,title:"我的现金券",icon:"coupon-filled"})}}),f=a.createClass({displayName:"Coin",mixins:[s],componentDidMount:function(){this.setState({num:this.props.num})},handleClick:function(){var e=this;this.spinIcon(),this.getFlux().actions.me.getCoin(function(){e.stopSpinIcon()})},stopSpinIcon:function(){var e=this.findLoadingIcon(),t=e.getAttribute("class");e.setAttribute("class",t.replace(/active/,""))},spinIcon:function(){var e=this.findLoadingIcon(),t=e.getAttribute("class")+" active";e.setAttribute("class",t)},findLoadingIcon:function(){return r.findDOMNode(this).querySelector(".trigger-icon")},render:function(){return a.createElement(u,{className:"yinhua",num:this.props.num,onClick:this.handleClick,title:"账户余额",icon:"coin-filled"})}}),g=a.createClass({displayName:"Card",handleClick:function(){c("#!/card")},render:function(){return a.createElement(u,{className:"card",num:this.props.num,onClick:this.handleClick,title:o.tpl("我的{{CARD}}"),icon:"card-filled"})}}),E=a.createClass({displayName:"Setting",handleClick:function(){c("#!/setting")},render:function(){return a.createElement(u,{className:"setting",onClick:this.handleClick,title:"设置",icon:"setting-filled"})}}),N=a.createClass({displayName:"NavList",render:function(){var e=this.props.user,t=o.get("PRIVILEGE");return a.createElement("section",{className:"center-nav"},a.createElement(m,{num:e.orderCount}),a.createElement(p,{num:e.preorderCount}),t.MALL?a.createElement(d,null):null,t.TICKET?a.createElement(h,null):null,a.createElement(C,{num:i.get(e,"wallet.couponCount")}),a.createElement(f,{num:i.get(e,"wallet.coin")}),a.createElement(g,{num:i.get(e,"wallet.cardCount")}),a.createElement(E,null))}});e.exports=N}});