webpackJsonp([2],{734:function(e,t,n){"use strict";var r=n(229),a=n(139),s=n(131),o=n(735),i=n(736),c=n(739),l=n(740),m=n(141),u=n(591),d=n(592).StoreWatchMixin,h=n(742),p=n(226).redirect,g=(n(226).isMainAccount,n(226).hasLogged),E=["www.maizuo.com","m.maizuo.com","maizuo.com"],f=r.createClass({displayName:"LoginView",mixins:[u,d("AuthStore")],getStateFromFlux:function(){var e=this.getFlux().store("AuthStore");return{isLogged:e.getStatus()}},propTypes:{redirectUri:r.PropTypes.string},componentDidUpdate:function(){var e=this.props.redirectUri||"#!/center";return g()&&"false"===s("isMainAccount")?p("#!/account/bind-mobile?redirect_uri="+encodeURIComponent(this.props.redirectUri||"#!/center")):this.state.isLogged?setTimeout(function(){var t=a.parse(e),n=t.hostname;n&&!~E.indexOf(n)&&(window.confirm("你接下来将要访问的并非卖座电影的网页，是否继续?")||(e="#!/center")),p(e,{trigger:!0,replace:!0})},0):void 0},componentDidMount:function(){return g()&&"false"===s("isMainAccount")?p("#!/account/bind-mobile?redirect_uri="+encodeURIComponent(this.props.redirectUri||"#!/center")):void this.getFlux().actions.application.setNavbar({title:"登录"})},render:function(){var e,t=!!s(m.COOKIE_DEBUG),n=this.props.redirectUri||"#!/center";return e=h.app.isWechat()?r.createElement(i,{redirectUri:n}):h.app.isQQ()?r.createElement(l,null):h.app.isMQQBrowser()?r.createElement(c,null):t?"":r.createElement(o,{redirectUri:n}),r.createElement("section",{className:"login-view"},r.createElement("div",null,t?r.createElement(o,{redirectUri:n}):""),r.createElement("div",null,e))}});e.exports=f},735:function(e,t,n){"use strict";var r=n(229),a=(n(215),n(226).redirect),s=n(226).isMobile,o=(n(226).isEmail,n(226).isMainAccount,n(226).hasLogged,n(226).trim),i=n(5),c=n(386),l=n(591),m=n(592).StoreWatchMixin,u=n(141),d=(n(726),{INVALID_USERNAME:"请输入正确手机号",INVALID_EMPTY_PASSWORD:"密码不能为空",INVALID_EMPTY_NAME:"手机号不能为空",INVALID_EMPTY_CAPTCHA:"请输入图形验证码"}),h=r.createClass({displayName:"SmsCode",getInitialState:function(){return{msg:"发送验证码"}},handleClick:function(){this.props.hasSendSmsCode||this.props.onClick()},render:function(){return r.createElement("span",{className:"sms-code",onClick:this.handleClick},r.createElement("i",{className:"sms-code-row"}),r.createElement("i",{className:"sms-code-tex"},this.props.hasSendSmsCode?"重发("+this.props.cuntdownTime+")":this.state.msg))}}),p=r.createClass({displayName:"LoginForm",mixins:[l,m("AuthStore")],getStateFromFlux:function(){this.getFlux().store("AuthStore");return{}},getInitialState:function(){return{userType:u.AUTH_LOGIN_USER_TYPE_IS_INVALID,isShowCaptcha:!1,errorMsg:"",hasSendSmsCode:!1,hasDologged:!1,cuntdownTime:59,captchaUrl:"",captchaKey:""}},handleSubmit:function(e){var t=this;return e.preventDefault(),t.setState({errorMsg:""}),t.username=o(t.refs.username.value),t.password=o(t.refs.pwd.value),t.captcha=o(t.refs.code.value),""===t.username?t.setState({errorMsg:d.INVALID_EMPTY_NAME}):t.state.userType===u.AUTH_LOGIN_USER_TYPE_IS_INVALID?t.setState({errorMsg:d.INVALID_USERNAME}):""===t.password?t.setState({errorMsg:d.INVALID_EMPTY_PASSWORD}):""===t.captcha&&t.state.isShowCaptcha?t.setState({errorMsg:d.INVALID_EMPTY_CAPTCHA}):(t.confirmLoginType(),void t.doLogin())},confirmLoginType:function(){var e=this;if(e.state.userType===u.AUTH_LOGIN_USER_TYPE_IS_MOBILE){e.password.length}},doLogin:function(){var e=this;e.state.hasDologged||(e.setState({hasDologged:!0}),this.getFlux().actions.auth.login({username:e.username,password:e.password,loginType:e.loginType,code:e.captcha,codeKey:e.state.captchaKey},function(t,n){var r,s;if(e.setState({hasDologged:!1}),t&&confirm("登录失败，请重试")&&e.doLogin(),r=+i.get(n,"status"),s=i("body.data"),0!==r){if(r===-23117&&e.showCaptcha(),"false"===s.get("isMainAccount")){var o=e.props.redirectUri;return a("#!/account/bind-mobile?redirect_uri="+encodeURIComponent(o))}e.setState({errorMsg:i.get(n,"msg")})}}))},showCaptcha:function(){var e=this;e.getFlux().actions.auth.getCaptcha(function(t,n){return t?e.setState({errorMsg:t}):void e.setState({isShowCaptcha:!0,captchaUrl:n.url,captchaKey:n.key})})},changeUserType:function(e){this.setState({userType:e})},onUserNameChange:function(e){var t=o(e.target.value);this.setUserName(t)},setUserName:function(e){var t=this;t.loginType=u.AUTH_LOGIN_TYPE_IS_DEFAULT,s(e)?t.changeUserType(u.AUTH_LOGIN_USER_TYPE_IS_MOBILE):t.changeUserType(u.AUTH_LOGIN_USER_TYPE_IS_INVALID)},sendSmsCode:function(){var e=this;e.state.hasSendSmsCode||e.getFlux().actions.auth.sendCode({mobile:e.refs.username.value,type:u.AUTH_SMS_TYPE_IS_LOGIN},function(t,n){return t?e.setState({errorMsg:t}):(e.loginType=u.AUTH_LOGIN_TYPE_IS_CODE,e.setState({hasSendSmsCode:!0,errorMsg:""}),void e.timerCuntdown())})},timerCuntdown:function(){var e=this,t=59;e.timer=null,e.timer=setInterval(function(){0==t?(e.setState({hasSendSmsCode:!1,cuntdownTime:59}),clearInterval(e.timer),e.timer=null):e.setState({cuntdownTime:t--})},1e3)},componentWillUnmount:function(){var e=this;clearInterval(e.timer)},componentDidMount:function(){this.getFlux().actions.me.get();var e=this.refs.username;o(e.value)||e.focus()},render:function(){var e=this,t=c({"form-group":!0,captcha:!0,active:e.state.isShowCaptcha});return r.createElement("form",{onSubmit:this.handleSubmit},r.createElement("div",{className:"form-group"},r.createElement("input",{type:"text",className:"form-control",onChange:this.onUserNameChange,placeholder:"输入手机号",ref:"username"}),1==this.state.userType?r.createElement(h,{hasSendSmsCode:this.state.hasSendSmsCode,cuntdownTime:this.state.cuntdownTime,onClick:this.sendSmsCode}):"",r.createElement("div",{className:"input-bg"})),r.createElement("div",{className:"form-group"},r.createElement("input",{type:"password",className:"form-control",placeholder:"输入验证码",ref:"pwd"}),r.createElement("div",{className:"input-bg"})),r.createElement("div",{className:t},r.createElement("input",{type:"text",className:"form-control code",placeholder:"图形验证码",ref:"code"}),r.createElement("img",{src:e.state.captchaUrl,width:"100",height:"30",onClick:this.showCaptcha}),r.createElement("div",{className:"input-bg"})),r.createElement("span",{className:"wrong-msg"},this.state.errorMsg),r.createElement("button",{type:"submit",className:"center-block submit"},"登录"))}});e.exports=p},736:function(e,t,n){"use strict";var r=n(229),a=n(131),s=(n(215),n(226).redirect),o=n(737),i=n(141),c=n(591),l=n(592).StoreWatchMixin,m=r.createClass({displayName:"WechatForm",mixins:[c,l("AuthStore")],getStateFromFlux:function(){var e=this.getFlux().store("AuthStore");return{isLogged:e.getStatus()}},componentDidMount:function(){this.getFlux().actions.me.get()},handleConnect:function(){var e=window.location;s("/act/connect/wechat?url="+encodeURIComponent(e.href))},render:function(){var e=this.state.isLogged===!1;return a(i.COOKIE_DEBUG)?r.createElement("article",{className:"login-debug"},r.createElement(o,{onClick:this.handleConnect},"再次连接微信登录")):e?r.createElement("article",{className:"wechat-form"},r.createElement("p",null,r.createElement("img",{src:n(738),alt:"微信",width:"44"})),r.createElement(o,{onClick:this.handleConnect},"再次连接微信登录"),r.createElement("p",null,"微信授权信息已过期")):r.createElement("article",{className:"wechat-form"},r.createElement("p",null,r.createElement("img",{src:n(738),alt:"微信",width:"44"})),r.createElement(o,{onClick:this.handleConnect,disabled:!0},"正在连接微信登录..."))}});e.exports=m},737:function(e,t,n){"use strict";var r=(n(143),n(229)),a=n(386),s=r.createClass({displayName:"ConfirmButton",propTypes:{children:r.PropTypes.node,disabled:r.PropTypes.bool,onClick:r.PropTypes.func,className:r.PropTypes.string},handleClick:function(e){this.props.disabled||(this.props.onClick||function(){})(e)},render:function(){var e=a({"cpn-primary-button":!0,disabled:this.props.disabled});return r.createElement("button",{className:e+" "+(this.props.className||""),onClick:this.handleClick},this.props.children)}});e.exports=s},738:function(e,t,n){e.exports=n.p+"asset/e05d4035dbe292b19503356f1ddd6983.png"},739:function(e,t,n){"use strict";var r=n(229),a=n(226).redirect,s=n(737),o=n(141),i=n(131),c=n(591),l=n(592).StoreWatchMixin,m=function(){return i(o.COOKIE_IGNORE_MQQBROWSER)===o.COOKIE_IGNORE_MQQBROWSER_IS_ALL},u=r.createClass({displayName:"MQQBrowserForm",mixins:[c,l("AuthStore")],getStateFromFlux:function(){var e=this.getFlux().store("AuthStore");return{isLogged:e.getStatus()}},componentDidMount:function(){this.getFlux().actions.me.get()},componentDidUpdate:function(){m()||i(o.COOKIE_DEBUG)||this.handleConnect()},handleConnect:function(){var e=window.location,t="/act/connect/m-qq-browser?url="+encodeURIComponent(e.href);a(t)},render:function(){var e=this.state.isLogged===!1;return i(o.COOKIE_DEBUG)?r.createElement("article",{className:"login-debug"},r.createElement(s,{onClick:this.handleConnect},"再次连接登录")):m()?e?r.createElement("article",{className:"m-qq-browser-form"},r.createElement(s,{onClick:this.handleConnect},"再次连接登录"),r.createElement("p",null,"QQ浏览器授权信息已过期")):r.createElement("article",{className:"m-qq-browser-form"},r.createElement(s,{onClick:this.handleConnect,disabled:!0},"正在同步登录数据...")):r.createElement("div",null)}});e.exports=u},740:function(e,t,n){"use strict";var r=n(229),a=n(131),s=(n(215),n(226).redirect),o=n(737),i=n(141),c=n(591),l=n(592).StoreWatchMixin,m=r.createClass({displayName:"QQForm",mixins:[c,l("AuthStore")],getStateFromFlux:function(){var e=this.getFlux().store("AuthStore");return{isLogged:e.getStatus()}},componentDidMount:function(){this.getFlux().actions.me.get()},handleConnect:function(){var e=window.location,t="/act/connect/qq?url="+encodeURIComponent(e.href);s(t)},render:function(){var e=this.state.isLogged===!1;return a(i.COOKIE_DEBUG)?r.createElement("article",{className:"login-debug"},r.createElement(o,{onClick:this.handleConnect},"再次连接登录")):e?r.createElement("article",{className:"wechat-form"},r.createElement("p",null,r.createElement("img",{src:n(741),alt:"qq",width:"44"})),r.createElement(o,{onClick:this.handleConnect},"再次连接登录"),r.createElement("p",null,"QQ授权信息已过期")):r.createElement("article",{className:"wechat-form"},r.createElement("p",null,r.createElement("img",{src:n(741),alt:"qq",width:"44"})),r.createElement(o,{onClick:this.handleConnect,disabled:!0},"正在连接登录..."))}});e.exports=m},741:function(e,t,n){e.exports=n.p+"asset/0c0256446e77023a9fc3c3638f44a8ec.png"}});